env:
  BASE64registry: IyEvYmluL3NoCmNhc2UgJChhcmNoKSBpbgp4ODZfNjQpCiAgQVJDSD1hbWQ2NAogIDs7CmFhcmNoNjQpCiAgQVJDSD1hcm02NAogIDs7CmVzYWMKCnNldCAtZQoKaWYgWyAkIyAtZXEgMCBdOyB0aGVuCiAgZWNobwogIGVjaG8gIkV4YW1wbGUgMTogaW1hZ2UxIGltYWdlMiBpbWFnZTMgLi4uIgogIGVjaG8gIkV4YW1wbGUgMjogJFBXRC9hbHBpbmUxLnRneiAkUFdEL2J1c3lib3gyLnRneiAkUFdEL3JlZGlzLnRneiAuLi4iCiAgZWNobwogIGV4aXQKZmkKCmZvciBhcmc7IGRvCiAgaWYgdGFyIC10ZiAiJGFyZyIgMj4vZGV2L251bGwgfCBncmVwIC9fbWFuaWZlc3RzL3RhZ3MvJDsgdGhlbgogICAgdGd6PSRhcmcKICAgIHJvb3RkaXJlY3Rvcnk9JChncmVwIHJvb3RkaXJlY3Rvcnk6IC9ldGMvcmVnaXN0cnkvcmVnaXN0cnlfY29uZmlnLnltbCAyPi9kZXYvbnVsbCB8IGF3ayAne3ByaW50ICRORn0nKQogICAgaWYgWyAteiAiJHJvb3RkaXJlY3RvcnkiIF07IHRoZW4KICAgICAgcm9vdGRpcmVjdG9yeT0vdmFyL2xpYi9yZWdpc3RyeQogICAgZmkKICAgIGlmIFsgTGludXggPSAiJCh1bmFtZSkiIF0gJiYgWyAwID0gIiQoaWQgLXUpIiBdOyB0aGVuCiAgICAgIGVjaG8gInJvb3RkaXJlY3Rvcnk9JHJvb3RkaXJlY3RvcnkgZm9yIHJlZ2lzdHJ5LnRneigkdGd6KSIKICAgIGVsc2UKICAgICAgZWNobyAiT25seSBMaW51eChyb290KSBpcyBzdXBwb3J0ZWQgZm9yIHJlZ2lzdHJ5LnRneigkdGd6KSIKICAgICAgZXhpdAogICAgZmkKICAgIG1rZGlyIC1wICIkcm9vdGRpcmVjdG9yeSIKICAgIHRhciAteHpmICIkdGd6IiAtLXN0cmlwLWNvbXBvbmVudHM9MSAtQyAiJHJvb3RkaXJlY3RvcnkiCiAgICBjYXQgIiRyb290ZGlyZWN0b3J5L2ltYWdlcy50eHQiCiAgZmkKZG9uZQppZiBbIC1uICIkcm9vdGRpcmVjdG9yeSIgXTsgdGhlbgogIGV4aXQKZmkKCmlmICEgc2VhbG9zIHZlcnNpb24gLS1zaG9ydCA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICByZWFkb25seSBTRUFMT1M9NC4zLjcKICBjdXJsIC1rc1NMICJodHRwczovL21pcnJvci5naHByb3h5LmNvbS9naXRodWIuY29tL2xhYnJpbmcvc2VhbG9zL3JlbGVhc2VzL2Rvd25sb2FkL3YkU0VBTE9TL3NlYWxvc18ke1NFQUxPU31fbGludXhfJEFSQ0gudGFyLmd6IiB8IHN1ZG8gdGFyIC1DIC91c3IvYmluIC14enYgc2VhbG9zCmZpCmZvciBhQVJDSCBpbiBhbWQ2NCBhcm02NDsgZG8KICBmb3IgaW1nOyBkbwogICAgaWYgWyAiJGFBUkNIIiA9IGFtZDY0IF07IHRoZW4KICAgICAgZWNobyAiJGltZyIKICAgIGVsaWYgc2VhbG9zIGluc3BlY3QgIiRpbWciIHwganEgJy5tYW5pZmVzdHNbXS5wbGF0Zm9ybS5hcmNoaXRlY3R1cmUnIC1yIHwgZ3JlcCAtcSAkYUFSQ0g7IHRoZW4KICAgICAgZWNobyAiJGltZyIKICAgIGZpCiAgZG9uZSB8IHNvcnQgPmltYWdlcy50eHQKICBlY2hvICIkKiIgfCBzZWQgJ3N+IH5cbn5nJyB8IHNvcnQgPmltYWdlcy5vcmkKICBpZiBkaWZmIGltYWdlcy5vcmkgaW1hZ2VzLnR4dDsgdGhlbgogICAgcm0gLWYgaW1hZ2VzLm9yaQogIGZpCiAgc2VhbG9zIHJlZ2lzdHJ5IHNhdmUgLS1hcmNoPSRhQVJDSCAtLXJlZ2lzdHJ5LWRpcj1yZWdpc3RyeSAtLWltYWdlcz0iJChzZWQgJzphO047c35cbn4sfmc7dGEnIGltYWdlcy50eHQpIgogIGNwIC1hdiBpbWFnZXMuKiByZWdpc3RyeQogIGlmIGdyZXAgL2t1YmVybmV0ZXMgaW1hZ2VzLnR4dDsgdGhlbgogICAgdGFyIC16Y2YgInJlZ2lzdHJ5LnNlYWxvcy4kYUFSQ0gudGd6IiByZWdpc3RyeQogIGVsc2UKICAgIHRhciAtemNmICJyZWdpc3RyeS4kKGF3ayAtRjogJ3twcmludCAkMX0nIHJlZ2lzdHJ5L2ltYWdlcy50eHQgfCBhd2sgLUYvICd7cHJpbnQgJDF9JyB8IHNvcnQgfCB1bmlxIC1jIHwgc29ydCB8IHRhaWwgLW4gMSB8IGF3ayAne3ByaW50ICRORn0nKS4kYUFSQ0gudGd6IiByZWdpc3RyeQogIGZpCiAgcm0gLXJmIHJlZ2lzdHJ5CmRvbmUgJiYgbHMgLWx0IHJlZ2lzdHJ5LioKaWYgISBtYyAtLXZlcnNpb24gPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgY3VybCAta3NTTCAiaHR0cHM6Ly9kbC5taW4uaW8vY2xpZW50L21jL3JlbGVhc2UvbGludXgtJEFSQ0gvbWMiIC1vIG1jICYmIGNobW9kIGEreCBtYwogIHN1ZG8gbXYgLWZ2IG1jIC91c3IvYmluCmZpCgppZiBjdXJsIC1rc1NMICIkczNVUkwiOyB0aGVuCiAgbWMgYWxpYXMgcyBwbGF5ICIkczNVUkwiICIkczNBSyIgIiRzM1NLIgplbHNlCiAgbWMgbWIgLXAgInBsYXkvJHtTM1NFQUxPUyUlLyp9IgpmaQoKbWMgY3AgLS1tZDUgcmVnaXN0cnkuKiAicGxheS8kUzNTRUFMT1MiCm1jIGFsaWFzIHJtIHBsYXkK
  S3SEALOS: ${{ vars.S3SEALOS }}
  s3AK: ${{ secrets.s3AK }}
  s3SK: ${{ secrets.s3SK }}
  s3URL: ${{ vars.s3URL }}
jobs:
  i2r:
    runs-on: ubuntu-latest
    steps:
      - name: Building
        run: echo ${{ env.BASE64registry }} | base64 -d | sh -s ${{ inputs.images }}
    timeout-minutes: 60
name: images2sealos
on:
  workflow_dispatch:
    inputs:
      images:
        default: labring/kubernetes:v1.24.17-4.3.7 labring/flannel:0.27.4 labring/cert-manager:v1.12.17 labring/endpoints-operator:v0.2.3
        description: Save images to S3
        required: true
        type: string
