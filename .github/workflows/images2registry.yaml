env:
  BASE64registry: IyEvYmluL3NoCmNhc2UgJChhcmNoKSBpbgp4ODZfNjQpCiAgQVJDSD1hbWQ2NAogIDs7CmFhcmNoNjQpCiAgQVJDSD1hcm02NAogIDs7CmVzYWMKc2V0IC1lCmlmIFsgJCMgLWVxIDAgXTsgdGhlbgogIGVjaG8KICBlY2hvICJFeGFtcGxlIDE6IGFscGluZTozLjE2IGJ1c3lib3g6bGF0ZXN0IHJlZGlzOjYuMiIKICBlY2hvICJFeGFtcGxlIDI6ICRQV0QvYWxwaW5lLnRneiAkUFdEL2J1c3lib3gudGd6ICRQV0QvcmVkaXMudGd6IgogIGVjaG8KICBleGl0CmZpCmlmICEgc2VhbG9zIHZlcnNpb24gLS1zaG9ydCA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICByZWFkb25seSBTRUFMT1M9NC4zLjcKICBjdXJsIC1rc1NMICJodHRwczovL21pcnJvci5naHByb3h5LmNvbS9naXRodWIuY29tL2xhYnJpbmcvc2VhbG9zL3JlbGVhc2VzL2Rvd25sb2FkL3YkU0VBTE9TL3NlYWxvc18ke1NFQUxPU31fbGludXhfJEFSQ0gudGFyLmd6IiB8IHN1ZG8gdGFyIC1DIC91c3IvYmluIC14enYgc2VhbG9zCmZpCgpyZWFkb25seSBEb2NrZXJIdWI9ImRvY2tlci5pbyIKcmVhZG9ubHkgSE9TVD1sb2NhbGhvc3QKcmVhZG9ubHkgUE9SVD01NTU1NQpyZWFkb25seSBNRj0iJEhPU1Qvc2VhbG9zOiRQT1JUIgptZigpIHsKICBpbWdPPSIkKGVjaG8gIiQxIiB8IGF3ayAtRjogJ3twcmludCAkMX0nKSIKICBpbWdUPSIkKGVjaG8gIiQxIiB8IGF3ayAtRjogJ3twcmludCAkMn0nKSIKICBpZiBlY2hvICIke2ltZ08lJS8qfSIgfCBncmVwIC1xIFxcLjsgdGhlbgogICAgSGltZz0iJHtpbWdPJSUvKn0iCiAgICBUaW1nPSIke2ltZ08jKi99IgogIGVsc2UKICAgIEhpbWc9IiREb2NrZXJIdWIiCiAgICBpZiBlY2hvICIkaW1nTyIgfCBncmVwIC1xIC87IHRoZW4KICAgICAgVGltZz0iJGltZ08iCiAgICBlbHNlCiAgICAgIFRpbWc9ImxpYnJhcnkvJGltZ08iCiAgICBmaQogIGZpCiAgY2FzZSAkVGltZyBpbgogIGNvcmVkbnMvY29yZWRucykKICAgIGltZz0iJERvY2tlckh1Yi9jb3JlZG5zL2NvcmVkbnM6bGF0ZXN0IgogICAgOzsKICAqKQogICAgaW1nPSIkSGltZy8kVGltZzokaW1nVCIKICAgIDs7CiAgZXNhYwogIGVjaG8gIj09PSRpbWciCiAgaWYgISBzZWFsb3MgbWFuaWZlc3QgaW5zcGVjdCAiJGltZyI7IHRoZW4KICAgIGVjaG8gIltza2lwXSRpbWciCiAgICByZXR1cm4KICBmaQogIFJFUE9zaGEyNTY9IiQoCiAgICBzZWFsb3MgbWFuaWZlc3QgaW5zcGVjdCAiJGltZyIgMj4vZGV2L251bGwgfCBzZWQgJ3N+IH5+ZycgfCBncmVwIC12RSAnKG1lZGlhVHlwZXxzaXplKScgPiIkVVNFUi5zaGEyNTYiIHx8IHRydWUKICAgIGFtZDY0c2hhMjU2PSQoPCIkVVNFUi5zaGEyNTYiIHhhcmdzIHwgc2VkICdzfmRpZ2VzdDp+XG5+ZycgfCBncmVwIGFyY2hpdGVjdHVyZTphbWQ2NCB8IGdyZXAgb3M6bGludXggfCBhd2sgLUYsICd7cHJpbnQgJDF9JykKICAgIGFybTY0c2hhMjU2PSQoPCIkVVNFUi5zaGEyNTYiIHhhcmdzIHwgc2VkICdzfmRpZ2VzdDp+XG5+ZycgfCBncmVwIGFyY2hpdGVjdHVyZTphcm02NCB8IGdyZXAgb3M6bGludXggfCBhd2sgLUYsICd7cHJpbnQgJDF9JykKICAgIGlmIFsgLW4gIiRhbWQ2NHNoYTI1NiIgXSAmJiBbIC1uICIkYXJtNjRzaGEyNTYiIF07IHRoZW4KICAgICAgZWNobyAiZG9ja2VyOi8vJHtpbWclOip9QCRhbWQ2NHNoYTI1NiIKICAgICAgZWNobyAiZG9ja2VyOi8vJHtpbWclOip9QCRhcm02NHNoYTI1NiIKICAgIGVsc2UKICAgICAgZWNobyAiW3NraXBdYW1kNjRzaGEyNTY6JGFtZDY0c2hhMjU2IGFybTY0c2hhMjU2OiRhcm02NHNoYTI1NiIKICAgICAgcmV0dXJuCiAgICBmaQogICkiCiAgc2VhbG9zIG1hbmlmZXN0IHJtICIkTUYiID4vZGV2L251bGwgMj4mMSB8fCB0cnVlCiAgaWYgWyAtbiAiJFJFUE9zaGEyNTYiIF07IHRoZW4KICAgICMgc2hlbGxjaGVjayBkaXNhYmxlPVNDMjA4NgogICAgc2VhbG9zIG1hbmlmZXN0IGNyZWF0ZSAtLWFsbCAiJE1GIiAkUkVQT3NoYTI1NgogICAgaWYgc2VhbG9zIG1hbmlmZXN0IGluc3BlY3QgIiRNRiIgfCBncmVwIC1FICJhKHJtfG1kKTY0IjsgdGhlbgogICAgICBzZWFsb3MgbWFuaWZlc3QgcHVzaCAtLWFsbCAtLXJtICIkTUYiICJkb2NrZXI6Ly9sb2NhbGhvc3Q6JFBPUlQvJFRpbWc6JGltZ1QiCiAgICBlbHNlCiAgICAgIGVjaG8gIiRSRVBPc2hhMjU2IgogICAgZmkKICAgIHNlYWxvcyBybWkgLWFmCiAgZmkKfQpuZXRzdGF0IC10cGwgfCBncmVwIDokUE9SVCB8IGF3ayAne3ByaW50ICRORn0nIHwgYXdrIC1GLyAne3ByaW50ICQxfScgfCB4YXJncyBraWxsIC05IDI+L2Rldi9udWxsIHx8IHRydWUKcm0gLXJmIHJlZ2lzdHJ5CnNlYWxvcyByZWdpc3RyeSBzZXJ2ZSBmcyAtLWRpc2FibGUtbG9nZ2luZyAtcD0kUE9SVCByZWdpc3RyeSAmCnVudGlsIGN1cmwgLXNMICJsb2NhbGhvc3Q6JFBPUlQvdjIiID4vZGV2L251bGwgMj4mMTsgZG8gc2xlZXAgMTsgZG9uZQpmb3IgaW1nOyBkbwogIG1mICIkaW1nIgpkb25lCgpwZ3JlcCAtZiAic2VhbG9zIHJlZ2lzdHJ5IHNlcnZlIGZzIiB8IHhhcmdzIGtpbGwgLTkgMj4vZGV2L251bGwgfHwgdHJ1ZQpkYXRlCnRhciAtemNmICJyZWdpc3RyeS4kKGVjaG8gIiRAIiB8IGF3ayAtRjogJ3twcmludCAkTkZ9JyB8IHNvcnQgfCB1bmlxIC1jIHwgc29ydCB8IHRhaWwgLW4gMSB8IGF3ayAne3ByaW50ICRORn0nIHx8IGRhdGUgKyVzKS50Z3oiIHJlZ2lzdHJ5CmRhdGUKcm0gLXJmIHJlZ2lzdHJ5CmxzIC1sdCByZWdpc3RyeS4qCgppZiAhIG1jIC0tdmVyc2lvbiA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICBjdXJsIC1rc1NMICJodHRwczovL2RsLm1pbi5pby9jbGllbnQvbWMvcmVsZWFzZS9saW51eC0kQVJDSC9tYyIgLW8gbWMgJiYgY2htb2QgYSt4IG1jCiAgc3VkbyBtdiAtZnYgbWMgL3Vzci9iaW4KZmkKCmlmIGN1cmwgLWtzU0wgIiRzM1VSTCI7IHRoZW4KICBtYyBhbGlhcyBzIHBsYXkgIiRzM1VSTCIgIiRzM0FLIiAiJHMzU0siCmVsc2UKICBtYyBtYiAtcCAicGxheS8ke1MzU0VBTE9TJSUvKn0iCmZpCgpkYXRlCm1jIGNwIC0tbWQ1IHJlZ2lzdHJ5LiogInBsYXkvJFMzU0VBTE9TIgpkYXRlCm1jIGFsaWFzIHJtIHBsYXkK
  S3SEALOS: ${{ vars.S3SEALOS }}
  s3AK: ${{ secrets.s3AK }}
  s3SK: ${{ secrets.s3SK }}
  s3URL: ${{ vars.s3URL }}
jobs:
  i2r:
    runs-on: ubuntu-latest
    steps:
      - name: Building
        run: echo ${{ env.BASE64registry }} | base64 -d | sh -s ${{ inputs.images }}
    timeout-minutes: 60
name: images2registry
on:
  workflow_dispatch:
    inputs:
      images:
        default: alpine:latest busybox:stable-glibc
        description: Save images to S3
        required: true
        type: string
